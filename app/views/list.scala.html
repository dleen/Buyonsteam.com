@(currentPage: Page[(Game, Option[Price])], currentOrderBy: Int,
currentFilter: String)(implicit flash: play.api.mvc.Flash)

@***************
* Helper links *
***************@
@link(newPage: Int, newOrderBy: Option[Int] = None) = @{
routes.Application.list(newPage, newOrderBy.map { orderBy =>
if(orderBy == scala.math.abs(currentOrderBy)) -currentOrderBy
else orderBy
}.getOrElse(currentOrderBy), currentFilter)
}

@**********************************
* Helper generating table headers *
**********************************@
@header(orderBy: Int, title: String) = {
<th class="col@orderBy header @if(scala.math.abs(currentOrderBy) ==
orderBy) @{if(currentOrderBy < 0) "headerSortDown" else "headerSortUp"}">
<a hrf="@link(0, Some(orderBy))">@title</a>
</th>
}

@main {

<div class="hero-unit" id="tttest">
	<h1> Should I Buy Or Wait?</h1>
	<p>Up to date info on the latest deals on Steam.</p>
	@helper.form(action=routes.Application.list()) {
	<input type="search" id="searchbox" class="input-xlarge autocomplete" name="f" value="@currentFilter" placeholder="Search for a game..." data-url="@{routes.Application.autocompleteSearch()}" autocomplete="off"><br>
	<input type="submit" id="searchsubmit" value="Buy Or Wait?" class="btn btn-primary">
}
</div>


<div class="row-fluid">
	<div class="span12">
		@Option(currentPage.items).filterNot(_.isEmpty).map { games =>
		<table class="table table-striped table-bordered">
			<thead>
				<tr>
					@header(2, "Game")
					@header(3, "Release Date")
					@header(4, "Metacritic")
					@header(5, "Price On Steam")
					@header(6, "On Sale?")
				</tr>
			</thead>
			<tbody>	
				@games.map {
				case (game, price) => {
				<tr>
					<td> @game.name </td>
					<td> @game.releaseDate </td>
					<td> @game.metacritic.getOrElse { <em>-</em> } </td>
					<td> @price.map(_.priceOnSteam).getOrElse { <em>Free</em> } </td>
					<td>@price.map(_.onSale).getOrElse {} </td>
				</tr>
			}
		}
	</tbody>
</table>

<div id="pagination" class="pagination pagination-centered">
	<ul>
		@currentPage.prev.map { page =>
		<li class="prev">
			<a href="@link(page)"><i class="icon-arrow-left"></i> Previous</a>
		</li>
	}.getOrElse {
	<li class="prev disabled">
		<a>&larr; Previous </a>
	</li>
}
<li class="current">
	<a>Displaying @(currentPage.offset + 1) to
		@(currentPage.offset + games.size) of
		@currentPage.total</a>
	</li>
	@currentPage.next.map { page =>
	<li class="next">
		<a href="@link(page)">Next <i class="icon-arrow-right"></i></a>
	</li>
}.getOrElse {
<li class="next disabled">
	<a>Next &rarr;</a>
</li>
}
</ul>
</div>


}.getOrElse {
<div class="well">
	<em>Nothing to display</em>
</div> }

</div>
</div>
}
